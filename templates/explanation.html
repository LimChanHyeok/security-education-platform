<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì‹œë‚˜ë¦¬ì˜¤ë³„ ì½”ë“œ ì„¤ëª…</title>
  <style>
    body { 
      font-family: monospace; 
      background: #f0f0f0; 
      padding: 20px; 
    }
    .section-buttons { 
      margin-bottom: 20px; 
    }
    button { 
      padding: 8px 14px; 
      margin: 5px; 
      cursor: pointer; 
    }
    .code-box { 
      display: none; 
    }
    .active { 
      display: block; 
    }
    /* ë³€ê²½: í° ë°°ê²½ì— ê²€ì€ ê¸€ì”¨ */
    .code-text-block {
      background: #fff;       /* í° ë°°ê²½ */
      color: #000;            /* ê²€ì€ ê¸€ì”¨ */
      border: 1px solid #ccc; /* ì„ íƒ: í…Œë‘ë¦¬ ì¶”ê°€ */
      padding: 10px;
      border-radius: 5px;
      white-space: pre-wrap;
      margin-bottom: 20px;
    }
    .code-line {
      display: flex;
      align-items: flex-start;
      margin-bottom: 6px;
    }
    .code-text {
      background: #fff;       /* í° ë°°ê²½ */
      color: #000;            /* ê²€ì€ ê¸€ì”¨ */
      padding: 6px 10px;
      border-radius: 5px;
      width: 100%;
      white-space: pre;
    }
    .toggle-btn {
      margin-right: 6px;
      cursor: pointer;
      background: none;
      border: none;
      font-size: 14px;
      color: #333;
    }
    .explanation {
      margin-left: 24px;
      margin-top: 4px;
      color: #333;
      background: #fff8dc;
      padding: 6px 10px;
      border-left: 4px solid orange;
      border-radius: 4px;
      display: none;
      white-space: pre-wrap;
    }
    .show { 
      display: block; 
    }
  </style>
</head>
<body>
  <h2>ğŸ” ì‹œë‚˜ë¦¬ì˜¤ë³„ ì½”ë“œ ì„¤ëª…</h2>
  <div class="section-buttons">
    <button onclick="showSection('dos')">ğŸ’¥ DoS ê³µê²© ì„¤ëª…</button>
    <button onclick="showSection('dosdef')">ğŸ›¡ï¸ DoS ë°©ì–´ ì„¤ëª…</button>
    <button onclick="showSection('portscan')">ğŸ” í¬íŠ¸ ìŠ¤ìº” ì„¤ëª…</button>
    <button onclick="showSection('portscan_def')">ğŸ›¡ï¸ í¬íŠ¸ ìŠ¤ìº” ë°©ì–´ ì„¤ëª…</button>
  </div>

  <!-- DoS ê³µê²© ì„¹ì…˜ -->
  <div id="dos" class="code-box active">
    <h3>ğŸ’¥ DoS ê³µê²© í•¨ìˆ˜ (dos_attack)</h3>
    <div class="code-text-block">
def dos_attack(ip, port, rate):
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    message = b"Flood" * 10
    while attack_running:
        for _ in range(rate):
            sock.sendto(message, (ip, port))
    </div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(0)">â–¶</button><code class="code-text">def dos_attack(ip, port, rate):</code></div>
    <div id="exp0" class="explanation">Dos ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜: ip, port, rateë¥¼ ì¸ìë¡œ ë°›ìŠµë‹ˆë‹¤.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(1)">â–¶</button><code class="code-text">    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</code></div>
    <div id="exp1" class="explanation">UDP ì†Œì¼“ì„ ìƒì„±í•©ë‹ˆë‹¤.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(2)">â–¶</button><code class="code-text">    message = b"Flood" * 10</code></div>
    <div id="exp2" class="explanation">Flood ë¬¸ìì—´ì„ ë°˜ë³µí•´ íŒ¨í‚· í¬ê¸°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(3)">â–¶</button><code class="code-text">    while attack_running:</code></div>
    <div id="exp3" class="explanation">attack_runningì´ Trueì¸ ë™ì•ˆ ë£¨í”„ ì‹¤í–‰.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(4)">â–¶</button><code class="code-text">        for _ in range(rate):</code></div>
    <div id="exp4" class="explanation">rateë§Œí¼ íŒ¨í‚·ì„ ì „ì†¡í•˜ê¸° ìœ„í•œ ë°˜ë³µë¬¸.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(5)">â–¶</button><code class="code-text">            sock.sendto(message, (ip, port))</code></div>
    <div id="exp5" class="explanation">sock.sendtoë¡œ ëŒ€ìƒ IP, í¬íŠ¸ë¡œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.</div>
  </div>

  <!-- DoS ë°©ì–´ ì„¹ì…˜ -->
  <div id="dosdef" class="code-box">
    <h3>ğŸ›¡ï¸ DoS ë°©ì–´ ì½”ë“œ</h3>
    <div class="code-text-block">
#  DoS ê°ì§€
packet_counter[ip] = [t for t in packet_counter[ip] if now - t < 1.0]
packet_counter[ip].append(now)
count = len(packet_counter[ip])

if ip not in blocked_ips and count > threshold:
    blocked_ips.add(ip)
    log_msg = (
        f"ğŸ›‘ [DoS ê³µê²© ê°ì§€: UDP Flood]\\n"
        f"ê³µê²© IP: {ip}\\n"
        f"ì´ˆë‹¹ íŒ¨í‚· ìˆ˜: {count} (ì„ê³„ì¹˜ {threshold} ì´ˆê³¼)\\n"
        f" ì°¨ë‹¨ë¨"
    )
    socketio.emit("log", log_msg)
    socketio.emit("blocked", list(blocked_ips))
    return
    </div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(6)">â–¶</button><code class="code-text">packet_counter[ip] = [t for t in packet_counter[ip] if now - t < 1.0]</code></div>
    <div id="exp6" class="explanation">1ì´ˆ ì´ë‚´ì˜ íƒ€ì„ìŠ¤íƒ¬í”„ë§Œ ë‚¨ê¹ë‹ˆë‹¤.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(7)">â–¶</button><code class="code-text">packet_counter[ip].append(now)</code></div>
    <div id="exp7" class="explanation">í˜„ì¬ ì‹œê°ì„ ê¸°ë¡í•©ë‹ˆë‹¤.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(8)">â–¶</button><code class="code-text">count = len(packet_counter[ip])</code></div>
    <div id="exp8" class="explanation">ìµœê·¼ 1ì´ˆê°„ íŒ¨í‚· ìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(9)">â–¶</button><code class="code-text">if ip not in blocked_ips and count > threshold:</code></div>
    <div id="exp9" class="explanation">ì„ê³„ì¹˜ ì´ˆê³¼ ì‹œ ì°¨ë‹¨ ì²˜ë¦¬ ì¡°ê±´.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(10)">â–¶</button><code class="code-text">    blocked_ips.add(ip)</code></div>
    <div id="exp10" class="explanation">ì°¨ë‹¨ ëª©ë¡ì— IP ì¶”ê°€.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(11)">â–¶</button><code class="code-text">    socketio.emit("log", log_msg)</code></div>
    <div id="exp11" class="explanation">ë¡œê·¸ ë©”ì‹œì§€ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(12)">â–¶</button><code class="code-text">    socketio.emit("blocked", list(blocked_ips))</code></div>
    <div id="exp12" class="explanation">ì°¨ë‹¨ ëª©ë¡ì„ ê°±ì‹ í•©ë‹ˆë‹¤.</div>
  </div>

  <!-- í¬íŠ¸ ìŠ¤ìº” ì„¹ì…˜ -->
  <div id="portscan" class="code-box">
    <h3>ğŸ” í¬íŠ¸ ìŠ¤ìº” í•¨ìˆ˜ (scan_port)</h3>
    <div class="code-text-block">
def scan_port(ip, port, result_list):
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
        result = sock.connect_ex((ip, port))
        result_list.append((port, result == 0))
    </div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(15)">â–¶</button><code class="code-text">def scan_port(ip, port, result_list):</code></div>
    <div id="exp15" class="explanation">í¬íŠ¸ ìŠ¤ìº” í•¨ìˆ˜ ì •ì˜</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(16)">â–¶</button><code class="code-text">    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:</code></div>
    <div id="exp16" class="explanation">TCP ì†Œì¼“ì„ ìƒì„±í•˜ê³  ìë™ ì¢…ë£Œ</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(17)">â–¶</button><code class="code-text">        result = sock.connect_ex((ip, port))</code></div>
    <div id="exp17" class="explanation">í¬íŠ¸ ì—°ê²° ì‹œë„ ê²°ê³¼ë¥¼ í™•ì¸</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(18)">â–¶</button><code class="code-text">        result_list.append((port, result == 0))</code></div>
    <div id="exp18" class="explanation">ì—´ë ¤ ìˆìœ¼ë©´ True, ì•„ë‹ˆë©´ False</div>
  </div>

  <!-- í¬íŠ¸ ìŠ¤ìº” ë°©ì–´ ì„¹ì…˜ -->
  <div id="portscan_def" class="code-box">
    <h3>ğŸ›¡ï¸ í¬íŠ¸ ìŠ¤ìº” ë°©ì–´ ì½”ë“œ</h3>
    <div class="code-text-block">
#  í¬íŠ¸ ìŠ¤ìº” ê°ì§€
if data.get("protocol") == "TCP" and dst_port:
    portscan_counter[ip] = [t for t in portscan_counter[ip] if now - t < 1.0]
    portscan_counter[ip].append(now)
    scan_rate = len(portscan_counter[ip])

    if ip not in blocked_ips and scan_rate > scan_threshold:
        blocked_ips.add(ip)
        log_msg = (
            f"ğŸ›‘ [í¬íŠ¸ ìŠ¤ìº” ê°ì§€]\\n"
            f"ê³µê²© IP: {ip}\\n"
            f"1ì´ˆë‚´ ì‹œë„: {scan_rate}ê°œ (ì„ê³„ì¹˜ {scan_threshold})\\n"
            f" ì°¨ë‹¨ë¨"
        )
        socketio.emit("log", log_msg)
        socketio.emit("blocked", list(blocked_ips))
    </div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(19)">â–¶</button><code class="code-text">if data.get("protocol") == "TCP" and dst_port:</code></div>
    <div id="exp19" class="explanation">TCP í”„ë¡œí† ì½œ & í¬íŠ¸ ì¡´ì¬ ì—¬ë¶€ í™•ì¸</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(20)">â–¶</button><code class="code-text">portscan_counter[ip] = [t for t in portscan_counter[ip] if now - t < 1.0]</code></div>
    <div id="exp20" class="explanation">1ì´ˆ ì´ë‚´ ì‹œë„ë§Œ ìœ ì§€</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(21)">â–¶</button><code class="code-text">portscan_counter[ip].append(now)</code></div>
    <div id="exp21" class="explanation">í˜„ì¬ ì‹œê°„ ê¸°ë¡</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(22)">â–¶</button><code class="code-text">scan_rate = len(portscan_counter[ip])</code></div>
    <div id="exp22" class="explanation">ì‹œë„ íšŸìˆ˜ ê³„ì‚°</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(23)">â–¶</button><code class="code-text">if ip not in blocked_ips and scan_rate > scan_threshold:</code></div>
    <div id="exp23" class="explanation">ì„ê³„ì¹˜ ì´ˆê³¼ ì‹œ ì°¨ë‹¨</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(24)">â–¶</button><code class="code-text">blocked_ips.add(ip)</code></div>
    <div id="exp24" class="explanation">ì°¨ë‹¨ ëª©ë¡ì— ì¶”ê°€</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(25)">â–¶</button><code class="code-text">socketio.emit("log", log_msg)</code></div>
    <div id="exp25" class="explanation">ë¡œê·¸ ì „ì†¡</div>
    <div class="code-line"><button class="toggle-btn" onclick="toggle(26)">â–¶</button><code class="code-text">socketio.emit("blocked", list(blocked_ips))</code></div>
    <div id="exp26" class="explanation">UI ê°±ì‹ </div>
  </div>

  <script>
    function showSection(id) {
      document.querySelectorAll('.code-box').forEach(el => el.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }
    function toggle(index) {
      const exp = document.getElementById('exp' + index);
      if (exp) exp.classList.toggle('show');
    }
  </script>
</body>
</html>
